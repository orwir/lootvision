{"version":3,"file":"component---src-pages-game-version-filter-tsx-e43f8140b2e915f92388.js","mappings":"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","sources":["webpack://occamfilter/./src/lib/data.ts","webpack://occamfilter/./src/components/filter/context.tsx","webpack://occamfilter/./src/components/filter/categories.tsx","webpack://occamfilter/./src/components/filter/action.tsx","webpack://occamfilter/./src/components/filter/condition.tsx","webpack://occamfilter/./src/components/filter/rule.tsx","webpack://occamfilter/./src/components/filter/category.tsx","webpack://occamfilter/./src/pages/{Game.version}/filter/[...].tsx"],"sourcesContent":["import { uuidv4 } from './utils';\r\n\r\nexport type Filter = {\r\n  game: string;\r\n  leagueVersion: string;\r\n  leagueName: string;\r\n  id: string;\r\n  name: string;\r\n  description: string;\r\n  lastUpdated: Date;\r\n  categories: Category[];\r\n};\r\n\r\nexport type Category = {\r\n  id: string;\r\n  name: string;\r\n  rules: Rule[];\r\n};\r\n\r\nexport type Rule = {\r\n  id: string;\r\n  name: string;\r\n  description: string;\r\n  actions: Action[];\r\n  conditions: Condition[];\r\n};\r\n\r\nexport type Action = {\r\n  id: string;\r\n  label: string;\r\n  description: string;\r\n  name: string;\r\n  value: string;\r\n};\r\n\r\nexport type Condition = {\r\n  id: string;\r\n  label: string;\r\n  description: string;\r\n  name: string;\r\n  value: string;\r\n};\r\n\r\nexport const EmptyFilter = {\r\n  game: '',\r\n  leagueVersion: '',\r\n  leagueName: '',\r\n  id: uuidv4(),\r\n  name: '',\r\n  lastUpdated: new Date(),\r\n  description: '',\r\n  categories: [],\r\n};\r\n","import { EmptyFilter, Filter, Category } from '@/lib/data';\r\nimport { createContext } from 'react';\r\n\r\nexport const FilterContext = createContext<{\r\n  filter: Filter;\r\n  setFilter: (filter: Filter) => void;\r\n}>({\r\n  filter: EmptyFilter,\r\n  setFilter: () => {},\r\n});\r\n\r\nexport const CategoryContext = createContext<{\r\n  category: Category | null;\r\n  setCategory: (category: Category) => void;\r\n}>({\r\n  category: null,\r\n  setCategory: () => {},\r\n});\r\n","import clsx from 'clsx';\r\nimport React, { useContext } from 'react';\r\nimport { Editable, IconButton } from '@/components/widgets';\r\nimport { CategoryContext, FilterContext } from '@/components/filter/context';\r\nimport { uuidv4 } from '@/lib/utils';\r\nimport { Category } from '@/lib/data';\r\n\r\nexport default function Categories() {\r\n  const { filter, setFilter } = useContext(FilterContext);\r\n  const { category, setCategory } = useContext(CategoryContext);\r\n  const index = category ? filter.categories.indexOf(category) : -1;\r\n\r\n  function selectCategory(category: Category) {\r\n    setCategory(category);\r\n  }\r\n\r\n  function createCategory() {\r\n    const category = {\r\n      id: uuidv4(),\r\n      name: '',\r\n      rules: [],\r\n    };\r\n    setFilter({\r\n      ...filter,\r\n      categories: [...filter.categories, category],\r\n    });\r\n    setCategory(category);\r\n  }\r\n\r\n  function changeCategoryName(category: Category, name: string) {\r\n    category = { ...category, name: name };\r\n\r\n    setFilter({\r\n      ...filter,\r\n      categories: filter.categories.map((v) => {\r\n        if (v.id === category.id) {\r\n          return category;\r\n        }\r\n        return v;\r\n      }),\r\n    });\r\n    setCategory(category);\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex w-[20ch] flex-col\">\r\n      {filter.categories.map((category, idx) => (\r\n        <div\r\n          key={category.id}\r\n          className={clsx(\r\n            'w-full items-center border-b border-r border-neutral-500 text-left text-xl',\r\n            {\r\n              'border-b-0 border-r-0 font-bold': idx === index,\r\n              'rounded-tr-md border-t': idx === index + 1,\r\n              'rounded-br-md': idx === index - 1,\r\n              'text-neutral-400 hover:text-teal-500': idx !== index,\r\n            }\r\n          )}\r\n        >\r\n          {/* using hidden to avoid the bug where name change doesn't saved if element gone completely */}\r\n          <Editable\r\n            className={clsx('mx-3 my-4 w-full truncate text-left', {\r\n              hidden: idx !== index,\r\n            })}\r\n            text={category.name}\r\n            placeholder=\"category...\"\r\n            onTextChange={(name) => changeCategoryName(category, name)}\r\n          />\r\n          <button\r\n            className={clsx('w-full truncate px-3 py-4 text-left', {\r\n              hidden: idx === index,\r\n            })}\r\n            onClick={() => selectCategory(category)}\r\n          >\r\n            {category.name ? category.name : '...'}\r\n          </button>\r\n        </div>\r\n      ))}\r\n      <div\r\n        className={clsx(\r\n          'flex w-[20ch] flex-grow border-r border-neutral-500 px-2 pt-8',\r\n          {\r\n            'rounded-tr-md border-t': index === filter.categories.length - 1,\r\n          }\r\n        )}\r\n      >\r\n        <IconButton\r\n          icon=\"mingcute:file-new-line\"\r\n          text={'New category'}\r\n          onClick={createCategory}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { Action as ActionModel } from '@/lib/data';\r\n\r\nexport default function Action({\r\n  action,\r\n  config,\r\n}: {\r\n  action: ActionModel;\r\n  config: Config;\r\n}) {\r\n  // TODO: implement specific actions based on action type\r\n  return (\r\n    <div className=\"flex flex-row\">\r\n      <div\r\n        style={{ width: `${config.width}ch` }}\r\n        className=\"border-b border-neutral-500\"\r\n      >\r\n        {action.label}\r\n      </div>\r\n      <div className=\"truncate border-b border-neutral-500 pe-2 ps-2\">\r\n        {action.value}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport type Config = {\r\n  width: number;\r\n  editable?: boolean;\r\n};\r\n","import React from 'react';\r\nimport { Condition as ConditionModel } from '@/lib/data';\r\n\r\nexport default function Condtion({\r\n  condition,\r\n  config,\r\n}: {\r\n  condition: ConditionModel;\r\n  config: Config;\r\n}) {\r\n  // TODO: implement specific conditions based on condition type\r\n  return (\r\n    <div className=\"flex flex-row\">\r\n      <div\r\n        style={{ width: `${config.width}ch` }}\r\n        className=\"border-b border-neutral-500\"\r\n      >\r\n        {condition.label}\r\n      </div>\r\n      <div className=\"truncate border-b border-neutral-500 pe-2 ps-2\">\r\n        {condition.value}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport type Config = {\r\n  width: number;\r\n  editable?: boolean;\r\n};\r\n","import React, { useContext, useState } from 'react';\r\nimport { Editable, IconButton } from '@/components/widgets';\r\nimport { Rule as RuleModel } from '@/lib/data';\r\nimport Action from '@/components/filter/action';\r\nimport Condition from '@/components/filter/condition';\r\nimport clsx from 'clsx';\r\nimport { CategoryContext, FilterContext } from '@/components/filter/context';\r\n\r\nexport default function Rule({ rule }: { rule: RuleModel }) {\r\n  const { filter, setFilter } = useContext(FilterContext);\r\n  const { category, setCategory } = useContext(CategoryContext);\r\n  const [expanded, setExpanded] = useState(false);\r\n\r\n  const longestLabel = [...rule.actions, ...rule.conditions].reduce(\r\n    (max, value) => Math.max(value.label.length, max),\r\n    0\r\n  );\r\n\r\n  function deleteRule() {\r\n    if (!category) return; // Should never happen\r\n\r\n    const updated = {\r\n      ...category,\r\n      rules: category.rules.filter((r) => r !== rule),\r\n    };\r\n    setFilter({\r\n      ...filter,\r\n      categories: filter.categories.map((c) =>\r\n        c.id === updated.id ? updated : c\r\n      ),\r\n    });\r\n    setCategory(updated);\r\n  }\r\n\r\n  function changeRuleName(name: string) {\r\n    if (!category) return; // Should never happen\r\n\r\n    const updated = {\r\n      ...category,\r\n      rules: category.rules.map((r) => (r.id === rule.id ? { ...r, name } : r)),\r\n    };\r\n    setFilter({\r\n      ...filter,\r\n      categories: filter.categories.map((c) =>\r\n        c.id === updated.id ? updated : c\r\n      ),\r\n    });\r\n    setCategory(updated);\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex w-full flex-col rounded-md border border-neutral-500\">\r\n      <div\r\n        className={clsx(\r\n          'flex w-full flex-row justify-between space-x-2 rounded-t-md bg-neutral-900 px-2 py-2',\r\n          {\r\n            'rounded-b-md': !expanded,\r\n          }\r\n        )}\r\n      >\r\n        <IconButton\r\n          icon={\r\n            expanded\r\n              ? 'mingcute:square-arrow-up-line'\r\n              : 'mingcute:square-arrow-down-line'\r\n          }\r\n          onClick={() => setExpanded(!expanded)}\r\n        />\r\n        <div className=\"flex-grow font-bold\">\r\n          <Editable\r\n            text={rule.name}\r\n            placeholder=\"rule...\"\r\n            onTextChange={changeRuleName}\r\n          />\r\n        </div>\r\n\r\n        <IconButton icon=\"mingcute:delete-2-line\" onClick={deleteRule} />\r\n      </div>\r\n      {expanded && (\r\n        <div className=\"w-full rounded-b-md bg-neutral-950 px-3 py-2\">\r\n          <div className=\"mb-2 flex h-28 flex-col items-center justify-center bg-slate-800\">\r\n            {/* Example of config */}\r\n            <div>Filter rule preview</div>\r\n            <div>Coming some day</div>\r\n          </div>\r\n          <div className=\"text-neutral-400\">Actions</div>\r\n          <div className=\"flex flex-col space-y-1\">\r\n            {rule.actions.map((action) => (\r\n              <Action\r\n                key={action.id}\r\n                action={action}\r\n                config={{ width: longestLabel }}\r\n              />\r\n            ))}\r\n          </div>\r\n          <div className=\"mt-4 text-neutral-400\">Conditions</div>\r\n          <div className=\"mb-2 flex flex-col space-y-1\">\r\n            {rule.conditions.map((condition) => (\r\n              <Condition\r\n                key={condition.id}\r\n                condition={condition}\r\n                config={{ width: longestLabel }}\r\n              />\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","import React, { useContext } from 'react';\r\nimport { CategoryContext, FilterContext } from '@/components/filter/context';\r\nimport Rule from '@/components/filter/rule';\r\nimport { IconButton } from '../widgets';\r\nimport { uuidv4 } from '@/lib/utils';\r\n\r\nexport default function Category() {\r\n  const { filter, setFilter } = useContext(FilterContext);\r\n  const { category, setCategory } = useContext(CategoryContext);\r\n\r\n  function deleteCategory() {\r\n    const index = Math.max(filter.categories.indexOf(category!) - 1, 0);\r\n    const categories = filter.categories.filter((c) => c !== category);\r\n\r\n    setFilter({\r\n      ...filter,\r\n      categories: categories,\r\n    });\r\n    setCategory(categories[index]);\r\n  }\r\n\r\n  function createRule() {\r\n    if (!category) return; // Should never happen\r\n\r\n    const updated = {\r\n      ...category,\r\n      rules: [\r\n        ...category.rules,\r\n        {\r\n          id: uuidv4(),\r\n          name: '',\r\n          description: '',\r\n          actions: [],\r\n          conditions: [],\r\n        },\r\n      ],\r\n    };\r\n\r\n    setFilter({\r\n      ...filter,\r\n      categories: filter.categories.map((c) =>\r\n        c.id === updated.id ? updated : c\r\n      ),\r\n    });\r\n    setCategory(updated);\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex w-full\">\r\n      {category && (\r\n        <div className=\"flex w-full flex-col space-y-2 px-4 py-2\">\r\n          {category.rules.map((rule) => (\r\n            <Rule rule={rule} key={rule.id} />\r\n          ))}\r\n          <div className=\"ps-2\">\r\n            <IconButton\r\n              icon=\"mingcute:add-square-line\"\r\n              text=\"New rule\"\r\n              onClick={createRule}\r\n            />\r\n          </div>\r\n          <div className=\"flex-grow\" />\r\n          <button\r\n            className=\"self-end hover:text-teal-500\"\r\n            onClick={deleteCategory}\r\n          >\r\n            Delete category\r\n          </button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","import Categories from '@/components/filter/categories';\r\nimport CategoryComponent from '@/components/filter/category';\r\nimport { CategoryContext, FilterContext } from '@/components/filter/context';\r\nimport Layout from '@/components/layout';\r\nimport Seo from '@/components/seo';\r\nimport { Dropdown, Editable } from '@/components/widgets';\r\nimport { Category, EmptyFilter, Filter } from '@/lib/data';\r\nimport { obtainFilter, saveFilter, uuidv4 } from '@/lib/utils';\r\nimport { graphql } from 'gatsby';\r\nimport React, { useEffect, useState } from 'react';\r\n\r\nexport default function FilterPage({\r\n  data,\r\n  params,\r\n}: {\r\n  data: { allPoeMetadata: { nodes: { version: string; league: string }[] } };\r\n  params: { version: string; '*': string };\r\n}) {\r\n  const { version, '*': id } = params;\r\n  const saved: Filter | null = obtainFilter(version, id);\r\n  if (!saved && id) {\r\n    return <FilterNotFound />;\r\n  }\r\n  const leagues: { name: string; version: string }[] =\r\n    data.allPoeMetadata.nodes.map((v) => ({\r\n      name: v.league,\r\n      version: v.version,\r\n    }));\r\n\r\n  const [filter, setFilter] = useState<Filter>(\r\n    saved || {\r\n      ...EmptyFilter,\r\n      game: version,\r\n      id: uuidv4(),\r\n      leagueVersion: leagues[0].version,\r\n      leagueName: leagues[0].name,\r\n    }\r\n  );\r\n  const [category, setCategory] = useState<Category | null>(\r\n    filter.categories[0]\r\n  );\r\n\r\n  useEffect(() => {\r\n    // saveFilter(filter);\r\n    console.log('saveFilter: ', filter);\r\n  }, [filter]);\r\n\r\n  return (\r\n    <Layout>\r\n      <FilterContext.Provider value={{ filter: filter, setFilter: setFilter }}>\r\n        <CategoryContext.Provider\r\n          value={{ category: category, setCategory: setCategory }}\r\n        >\r\n          <div className=\"flex h-full justify-center\">\r\n            <div className=\"flex w-[900px] flex-col space-y-2\">\r\n              <div className=\"flex flex-row items-center space-x-4 pt-2\">\r\n                <div className=\"w-44\">\r\n                  <Editable\r\n                    className=\"truncate px-3 text-lg\"\r\n                    text={filter.name}\r\n                    placeholder=\"filter name...\"\r\n                    onTextChange={(text) =>\r\n                      setFilter({\r\n                        ...filter,\r\n                        name: text,\r\n                      })\r\n                    }\r\n                  />\r\n                </div>\r\n                <div className=\"flex-grow\" />\r\n                <Dropdown\r\n                  data={leagues.map((v) => ({\r\n                    text: v.name,\r\n                    value: v,\r\n                  }))}\r\n                  onSelected={() => {}}\r\n                />\r\n              </div>\r\n              <div className=\"flex h-full flex-row rounded-md border border-neutral-500\">\r\n                <Categories />\r\n                <CategoryComponent />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </CategoryContext.Provider>\r\n      </FilterContext.Provider>\r\n    </Layout>\r\n  );\r\n}\r\n\r\nexport const Head = () => <Seo title=\"\" />;\r\n\r\nexport const query = graphql`\r\n  query ($version: String) {\r\n    allPoeMetadata(\r\n      filter: { game_version: { eq: $version } }\r\n      sort: { version: DESC }\r\n    ) {\r\n      nodes {\r\n        game_version\r\n        league\r\n        version\r\n      }\r\n    }\r\n  }\r\n`;\r\n\r\nfunction FilterNotFound() {\r\n  return (\r\n    <Layout>\r\n      <div className=\"font-ubuntu flex flex-col items-center space-y-6 pt-24\">\r\n        <div className=\"text-4xl\">Exile!</div>\r\n        <div className=\"text-3xl\">Your filter is in another browser!</div>\r\n        <div className=\"w-[38ch] whitespace-pre-wrap\">\r\n          ░░░░░░░░▄▄▄▀▀▀▄▄███▄░░░░░░░░░░░░░░ ░░░░░▄▀▀░░░░░░░▐░▀██▌░░░░░░░░░░░░░\r\n          ░░░▄▀░░░░▄▄███░▌▀▀░▀█░░░░░░░░░░░░░ ░░▄█░░▄▀▀▒▒▒▒▒▄▐░░░░█▌░░░░░░░░░░░░\r\n          ░▐█▀▄▀▄▄▄▄▀▀▀▀▌░░░░░▐█▄░░░░░░░░░░░ ░▌▄▄▀▀░░░░░░░░▌░░░░▄███████▄░░░░░░\r\n          ░░░░░░░░░░░░░▐░░░░▐███████████▄░░░ ░░░░░le░░░░░░░▐░░░░▐█████████████▄\r\n          ░░░░toucan░░░░░░▀▄░░░▐█████████████▄\r\n          ░░░░░░has░░░░░░░░▀▄▄███████████████ ░░░░░arrived░░░░░░░░░░░░█▀██████░░\r\n        </div>\r\n      </div>\r\n    </Layout>\r\n  );\r\n}\r\n"],"names":["EmptyFilter","game","leagueVersion","leagueName","id","uuidv4","name","lastUpdated","Date","description","categories","FilterContext","createContext","filter","setFilter","CategoryContext","category","setCategory","Categories","useContext","index","indexOf","React","className","map","idx","key","clsx","Editable","hidden","text","placeholder","onTextChange","v","changeCategoryName","onClick","selectCategory","length","IconButton","icon","rules","Action","action","config","style","width","label","value","Condtion","condition","Rule","rule","expanded","setExpanded","useState","longestLabel","actions","conditions","reduce","max","Math","updated","r","c","Condition","Category","FilterPage","data","params","version","saved","obtainFilter","FilterNotFound","leagues","allPoeMetadata","nodes","league","useEffect","console","log","Layout","Provider","Dropdown","onSelected","CategoryComponent","Head","Seo","title"],"sourceRoot":""}